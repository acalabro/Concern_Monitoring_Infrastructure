2026-01-20T10:58:09.980+0100 [grizzly-http-server-2] INFO  it.cnr.isti.labsedc.concern.ConcernApp - 

-----------------------------------------------------
- NEW MONITORING SESSION - ALL COMPONENTS RESTARTED -
-----------------------------------------------------



2026-01-20T10:58:09.981+0100 [grizzly-http-server-2] INFO  it.cnr.isti.labsedc.concern.ConcernApp - Starting components
2026-01-20T10:58:09.982+0100 [grizzly-http-server-2] DEBUG it.cnr.isti.labsedc.concern.ConcernApp - ConcernApp is launching the broker.
2026-01-20T10:58:09.982+0100 [grizzly-http-server-2] INFO  it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Start SSL Broker
2026-01-20T10:58:09.987+0100 [grizzly-http-server-2] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Creating TrasportConnector
2026-01-20T10:58:10.121+0100 [grizzly-http-server-2] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Waiting for broker start
2026-01-20T10:58:10.121+0100 [grizzly-http-server-2] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - broker started
2026-01-20T10:58:10.121+0100 [grizzly-http-server-2] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Enabling SSL ConnectionFactory
2026-01-20T10:58:10.137+0100 [grizzly-http-server-2] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Connection sucessfully created
2026-01-20T10:58:10.137+0100 [grizzly-http-server-2] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Component ActiveMQBrokerManager loaded in registry.
2026-01-20T10:58:10.137+0100 [grizzly-http-server-2] DEBUG it.cnr.isti.labsedc.concern.ConcernApp - ConcernApp broker launched.
2026-01-20T10:58:10.137+0100 [grizzly-http-server-2] INFO  it.cnr.isti.labsedc.concern.ConcernApp - Connecting to ActiveMQ
2026-01-20T10:58:10.137+0100 [grizzly-http-server-2] INFO  it.cnr.isti.labsedc.concern.ConcernApp - Connected to ActiveMQ
2026-01-20T10:58:10.137+0100 [grizzly-http-server-2] DEBUG it.cnr.isti.labsedc.concern.register.ChannelsManagementRegistry - into ChannelsManagementRegistry
2026-01-20T10:58:10.138+0100 [grizzly-http-server-2] DEBUG it.cnr.isti.labsedc.concern.register.ChannelsManagementRegistry - ChannelsManagementRegistry started
2026-01-20T10:58:10.138+0100 [grizzly-http-server-2] DEBUG it.cnr.isti.labsedc.concern.register.ChannelsManagementRegistry - ChannelsManagementRegistry loaded in registry.
2026-01-20T10:58:10.138+0100 [grizzly-http-server-2] DEBUG it.cnr.isti.labsedc.concern.ConcernApp - Channels Management Registry created
2026-01-20T10:58:10.434+0100 [grizzly-http-server-2] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - CEP creation 
2026-01-20T10:58:10.439+0100 [grizzly-http-server-2] INFO  it.cnr.isti.labsedc.concern.cep.EsperComplexEventProcessorManager - CEP creation 
2026-01-20T10:58:10.451+0100 [Thread-5] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne creates a listening channel called: DROOLS-InstanceOne
2026-01-20T10:58:10.451+0100 [Thread-6] INFO  it.cnr.isti.labsedc.concern.cep.EsperComplexEventProcessorManager - ...CEP named InstanceTwo creates a listening channel called: ESPER-InstanceTwo
2026-01-20T10:58:10.608+0100 [Thread-5] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne created Session and fires rules /home/acalabro/eclipse-workspace/Concern_Monitoring_Infrastructure/src/main/resources/startupRule.drl with knowledgePackages: [[Package name=it.cnr.isti.labsedc.concern.event]]
2026-01-20T10:58:19.644+0100 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne receives rules //created Jan 24, 2023 - 17:41:32
package it.cnr.isti.labsedc.concern.event;
import it.cnr.isti.labsedc.concern.event.ConcernAbstractEvent;
import it.cnr.isti.labsedc.concern.event.ConcernProbeEvent;
import it.cnr.isti.labsedc.concern.event.ConcernBaseEncryptedEvent;
import it.cnr.isti.labsedc.concern.utils.KieLauncher;
import it.cnr.isti.labsedc.concern.utils.Encrypter;
import it.cnr.isti.labsedc.concern.notification.NotificationManager;

//Check a sequence of events strictly

dialect "java"

declare ConcernBaseEncryptedEvent
    @role( event )
    @timestamp( timestamp )
    @expires(2m)
end

rule "decrypt"
no-loop
salience 1000
dialect "java"
when
	$aEvent: ConcernBaseEncryptedEvent(
		this.senderID == "ENCRYPTED_Probe",
		this.destinationID == "Monitoring",
		this.name == "EncryptedMessage",
		this.encryption == "AES",
		this.consumed == false);

then
		$aEvent.setConsumed(true);
		update($aEvent);
		Encrypter.decrypt($aEvent.getData().toString(),$aEvent.getEncryption());		
end

2026-01-20T10:58:19.924+0100 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne load rules received into the knowledgeBase
2026-01-20T10:58:19.925+0100 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - How many rules within package: it.cnr.isti.labsedc.concern.event 1
2026-01-20T10:58:25.571+0100 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne receives rules //created Jan 24, 2023 - 17:41:32
package it.cnr.isti.labsedc.concern.event;
import it.cnr.isti.labsedc.concern.event.ConcernAbstractEvent;
import it.cnr.isti.labsedc.concern.event.ConcernProbeEvent;
import it.cnr.isti.labsedc.concern.event.ConcernBaseEncryptedEvent;
import it.cnr.isti.labsedc.concern.utils.KieLauncher;
import it.cnr.isti.labsedc.concern.utils.Encrypter;
import it.cnr.isti.labsedc.concern.notification.NotificationManager;


dialect "java"

declare ConcernBaseEncryptedEvent
    @role( event )
    @timestamp( timestamp )
    @expires( 2m )
end

rule "CRYPTO_BASELINE_single_decrypt"
no-loop
salience 1000
dialect "java"
when
    $aEvent : ConcernBaseEncryptedEvent(
        this.senderID == "ENCRYPTED_Probe",
        this.destinationID == "Monitoring",
        this.name == "EncryptedMessage",
        this.encryption == "AES",
        this.consumed == false);
        
then
    String clear = Encrypter.decrypt($aEvent.getData().toString(),$aEvent.getEncryption());

    $aEvent.setData(clear);
    $aEvent.setConsumed(true);
    update($aEvent);
end

2026-01-20T10:58:25.601+0100 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne load rules received into the knowledgeBase
2026-01-20T10:58:25.601+0100 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - How many rules within package: it.cnr.isti.labsedc.concern.event 2
2026-01-20T10:58:31.873+0100 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne receives rules //created Jan 24, 2023 - 17:41:32
package it.cnr.isti.labsedc.concern.event;
import it.cnr.isti.labsedc.concern.event.ConcernAbstractEvent;
import it.cnr.isti.labsedc.concern.event.ConcernProbeEvent;
import it.cnr.isti.labsedc.concern.event.ConcernBaseEncryptedEvent;
import it.cnr.isti.labsedc.concern.utils.KieLauncher;
import it.cnr.isti.labsedc.concern.utils.Encrypter;
import it.cnr.isti.labsedc.concern.notification.NotificationManager;


dialect "java"

declare ConcernBaseEncryptedEvent
    @role( event )
    @timestamp( timestamp )
    @expires( 2m )
end

rule "CRYPTO_repeated_decrypt_stress"
salience 50
when
    $aEvent : ConcernBaseEncryptedEvent(
        this.senderID == "ENCRYPTED_Probe",
        this.destinationID == "Monitoring",
        this.name == "EncryptedMessage",
        this.encryption == "AES",
        this.consumed == false
    );
then
    for (int i = 0; i < 10; i++) {
    	String clear = Encrypter.decrypt($aEvent.getData().toString(),$aEvent.getEncryption());
    }
    $aEvent.setConsumed(true);
    update($aEvent);
end

2026-01-20T10:58:31.900+0100 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne load rules received into the knowledgeBase
2026-01-20T10:58:31.901+0100 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - How many rules within package: it.cnr.isti.labsedc.concern.event 3
2026-01-20T10:58:37.470+0100 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne receives rules //created Jan 24, 2023 - 17:41:32
package it.cnr.isti.labsedc.concern.event;
import it.cnr.isti.labsedc.concern.event.ConcernAbstractEvent;
import it.cnr.isti.labsedc.concern.event.ConcernProbeEvent;
import it.cnr.isti.labsedc.concern.event.ConcernBaseEncryptedEvent;
import it.cnr.isti.labsedc.concern.utils.KieLauncher;
import it.cnr.isti.labsedc.concern.utils.Encrypter;
import it.cnr.isti.labsedc.concern.notification.NotificationManager;
import it.cnr.isti.labsedc.concern.ConcernApp;

dialect "java"

declare ConcernBaseEncryptedEvent
    @role( event )
    @timestamp( timestamp )
    @expires( 2m )
end

rule "CRYPTO_db_amplification"

when
    $aEvent : ConcernBaseEncryptedEvent(
        this.senderID == "ENCRYPTED_Probe",
        this.destinationID == "Monitoring",
        this.name == "EncryptedMessage",
        this.encryption == "AES",
        this.consumed == false);
        
then
    String clear = Encrypter.decrypt($aEvent.getData().toString(),$aEvent.getEncryption());
    $aEvent.setData(clear);

    ConcernApp test = (ConcernApp)ConcernApp.getInstance();
    test.getStorageController().saveMessage($aEvent);
    test.getStorageController().saveMessage($aEvent);
    test.getStorageController().saveMessage($aEvent);
    
    $aEvent.setConsumed(true);
    update($aEvent);
end

2026-01-20T10:58:37.493+0100 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne load rules received into the knowledgeBase
2026-01-20T10:58:37.493+0100 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - How many rules within package: it.cnr.isti.labsedc.concern.event 4
