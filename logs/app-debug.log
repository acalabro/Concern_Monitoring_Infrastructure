2026-01-19T11:15:05.863+0100 [grizzly-http-server-1] INFO  it.cnr.isti.labsedc.concern.ConcernApp - 

-----------------------------------------------------
- NEW MONITORING SESSION - ALL COMPONENTS RESTARTED -
-----------------------------------------------------



2026-01-19T11:15:05.864+0100 [grizzly-http-server-1] INFO  it.cnr.isti.labsedc.concern.ConcernApp - Starting components
2026-01-19T11:15:05.866+0100 [grizzly-http-server-1] DEBUG it.cnr.isti.labsedc.concern.ConcernApp - ConcernApp is launching the broker.
2026-01-19T11:15:05.866+0100 [grizzly-http-server-1] INFO  it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Start SSL Broker
2026-01-19T11:15:05.871+0100 [grizzly-http-server-1] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Creating TrasportConnector
2026-01-19T11:15:06.005+0100 [grizzly-http-server-1] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Waiting for broker start
2026-01-19T11:15:06.005+0100 [grizzly-http-server-1] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - broker started
2026-01-19T11:15:06.006+0100 [grizzly-http-server-1] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Enabling SSL ConnectionFactory
2026-01-19T11:15:06.020+0100 [grizzly-http-server-1] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Connection sucessfully created
2026-01-19T11:15:06.020+0100 [grizzly-http-server-1] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Component ActiveMQBrokerManager loaded in registry.
2026-01-19T11:15:06.020+0100 [grizzly-http-server-1] DEBUG it.cnr.isti.labsedc.concern.ConcernApp - ConcernApp broker launched.
2026-01-19T11:15:06.020+0100 [grizzly-http-server-1] INFO  it.cnr.isti.labsedc.concern.ConcernApp - Connecting to ActiveMQ
2026-01-19T11:15:06.020+0100 [grizzly-http-server-1] INFO  it.cnr.isti.labsedc.concern.ConcernApp - Connected to ActiveMQ
2026-01-19T11:15:06.020+0100 [grizzly-http-server-1] DEBUG it.cnr.isti.labsedc.concern.register.ChannelsManagementRegistry - into ChannelsManagementRegistry
2026-01-19T11:15:06.020+0100 [grizzly-http-server-1] DEBUG it.cnr.isti.labsedc.concern.register.ChannelsManagementRegistry - ChannelsManagementRegistry started
2026-01-19T11:15:06.021+0100 [grizzly-http-server-1] DEBUG it.cnr.isti.labsedc.concern.register.ChannelsManagementRegistry - ChannelsManagementRegistry loaded in registry.
2026-01-19T11:15:06.021+0100 [grizzly-http-server-1] DEBUG it.cnr.isti.labsedc.concern.ConcernApp - Channels Management Registry created
2026-01-19T11:15:06.155+0100 [grizzly-http-server-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - CEP creation 
2026-01-19T11:15:06.161+0100 [grizzly-http-server-1] INFO  it.cnr.isti.labsedc.concern.cep.EsperComplexEventProcessorManager - CEP creation 
2026-01-19T11:15:06.177+0100 [Thread-6] INFO  it.cnr.isti.labsedc.concern.cep.EsperComplexEventProcessorManager - ...CEP named InstanceTwo creates a listening channel called: ESPER-InstanceTwo
2026-01-19T11:15:06.177+0100 [Thread-5] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne creates a listening channel called: DROOLS-InstanceOne
2026-01-19T11:15:06.374+0100 [Thread-5] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne created Session and fires rules /home/acalabro/eclipse-workspace/Concern_Monitoring_Infrastructure/src/main/resources/startupRule.drl with knowledgePackages: [[Package name=it.cnr.isti.labsedc.concern.event]]
2026-01-19T11:15:13.022+0100 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne receives rules //created Jan 24, 2023 - 17:41:32
package it.cnr.isti.labsedc.concern.event;
import it.cnr.isti.labsedc.concern.event.ConcernAbstractEvent;
import it.cnr.isti.labsedc.concern.event.ConcernProbeEvent;
import it.cnr.isti.labsedc.concern.event.ConcernBaseEncryptedEvent;
import it.cnr.isti.labsedc.concern.utils.KieLauncher;
import it.cnr.isti.labsedc.concern.utils.Encrypter;
import it.cnr.isti.labsedc.concern.notification.NotificationManager;

//Check a sequence of events strictly

dialect "java"

declare ConcernBaseEncryptedEvent
    @role( event )
    @timestamp( timestamp )
    @expires(2m)
end

rule "decrypt"
no-loop
salience 1000
dialect "java"
when
	$aEvent: ConcernBaseEncryptedEvent(
		this.senderID == "ENCRYPTED_Probe",
		this.destinationID == "Monitoring",
		this.name == "EncryptedMessage",
		this.encryption == "AES",
		this.consumed == false);

then
		$aEvent.setConsumed(true);
		update($aEvent);
		Encrypter.decrypt($aEvent.getData().toString(),"AES");		
end

2026-01-19T11:15:13.363+0100 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne load rules received into the knowledgeBase
2026-01-19T11:15:13.364+0100 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - How many rules within package: it.cnr.isti.labsedc.concern.event 1
