2026-01-20T12:07:51.962+0100 [grizzly-http-server-1] INFO  it.cnr.isti.labsedc.concern.ConcernApp - 

-----------------------------------------------------
- NEW MONITORING SESSION - ALL COMPONENTS RESTARTED -
-----------------------------------------------------



2026-01-20T12:07:51.964+0100 [grizzly-http-server-1] INFO  it.cnr.isti.labsedc.concern.ConcernApp - Starting components
2026-01-20T12:07:51.967+0100 [grizzly-http-server-1] DEBUG it.cnr.isti.labsedc.concern.ConcernApp - ConcernApp is launching the broker.
2026-01-20T12:07:51.967+0100 [grizzly-http-server-1] INFO  it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Start SSL Broker
2026-01-20T12:07:51.974+0100 [grizzly-http-server-1] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Creating TrasportConnector
2026-01-20T12:07:52.126+0100 [grizzly-http-server-1] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Waiting for broker start
2026-01-20T12:07:52.126+0100 [grizzly-http-server-1] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - broker started
2026-01-20T12:07:52.126+0100 [grizzly-http-server-1] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Enabling SSL ConnectionFactory
2026-01-20T12:07:52.142+0100 [grizzly-http-server-1] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Connection sucessfully created
2026-01-20T12:07:52.142+0100 [grizzly-http-server-1] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Component ActiveMQBrokerManager loaded in registry.
2026-01-20T12:07:52.142+0100 [grizzly-http-server-1] DEBUG it.cnr.isti.labsedc.concern.ConcernApp - ConcernApp broker launched.
2026-01-20T12:07:52.142+0100 [grizzly-http-server-1] INFO  it.cnr.isti.labsedc.concern.ConcernApp - Connecting to ActiveMQ
2026-01-20T12:07:52.142+0100 [grizzly-http-server-1] INFO  it.cnr.isti.labsedc.concern.ConcernApp - Connected to ActiveMQ
2026-01-20T12:07:52.143+0100 [grizzly-http-server-1] DEBUG it.cnr.isti.labsedc.concern.register.ChannelsManagementRegistry - into ChannelsManagementRegistry
2026-01-20T12:07:52.143+0100 [grizzly-http-server-1] DEBUG it.cnr.isti.labsedc.concern.register.ChannelsManagementRegistry - ChannelsManagementRegistry started
2026-01-20T12:07:52.143+0100 [grizzly-http-server-1] DEBUG it.cnr.isti.labsedc.concern.register.ChannelsManagementRegistry - ChannelsManagementRegistry loaded in registry.
2026-01-20T12:07:52.143+0100 [grizzly-http-server-1] DEBUG it.cnr.isti.labsedc.concern.ConcernApp - Channels Management Registry created
2026-01-20T12:07:52.454+0100 [grizzly-http-server-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - CEP creation 
2026-01-20T12:07:52.464+0100 [grizzly-http-server-1] INFO  it.cnr.isti.labsedc.concern.cep.EsperComplexEventProcessorManager - CEP creation 
2026-01-20T12:07:52.475+0100 [Thread-6] INFO  it.cnr.isti.labsedc.concern.cep.EsperComplexEventProcessorManager - ...CEP named InstanceTwo creates a listening channel called: ESPER-InstanceTwo
2026-01-20T12:07:52.475+0100 [Thread-5] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne creates a listening channel called: DROOLS-InstanceOne
2026-01-20T12:07:52.647+0100 [Thread-5] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne created Session and fires rules /home/acalabro/eclipse-workspace/Concern_Monitoring_Infrastructure/src/main/resources/startupRule.drl with knowledgePackages: [[Package name=it.cnr.isti.labsedc.concern.event]]
2026-01-20T12:08:01.138+0100 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne receives rules //created Jan 24, 2023 - 17:41:32
package it.cnr.isti.labsedc.concern.event;
import it.cnr.isti.labsedc.concern.event.ConcernAbstractEvent;
import it.cnr.isti.labsedc.concern.event.ConcernProbeEvent;
import it.cnr.isti.labsedc.concern.event.ConcernBaseEncryptedEvent;
import it.cnr.isti.labsedc.concern.utils.KieLauncher;
import it.cnr.isti.labsedc.concern.utils.Encrypter;
import it.cnr.isti.labsedc.concern.notification.NotificationManager;


dialect "java"

declare ConcernBaseEncryptedEvent
    @role( event )
    @timestamp( timestamp )
    @expires( 2m )
end

rule "CRYPTO_BASELINE_single_decrypt"
no-loop
salience 1000
dialect "java"
when
    $aEvent : ConcernBaseEncryptedEvent(
        this.senderID == "ENCRYPTED_Probe",
        this.destinationID == "Monitoring",
        this.name == "EncryptedMessage",
        this.encryption == "AES",
        this.consumed == false);
        
then
    String clear = Encrypter.decrypt($aEvent.getData().toString(),$aEvent.getEncryption());

    $aEvent.setConsumed(true);
    update($aEvent);
end

2026-01-20T12:08:01.441+0100 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne load rules received into the knowledgeBase
2026-01-20T12:08:01.442+0100 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - How many rules within package: it.cnr.isti.labsedc.concern.event 1
2026-01-20T12:08:07.573+0100 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne receives rules //created Jan 24, 2023 - 17:41:32
package it.cnr.isti.labsedc.concern.event;
import it.cnr.isti.labsedc.concern.event.ConcernAbstractEvent;
import it.cnr.isti.labsedc.concern.event.ConcernProbeEvent;
import it.cnr.isti.labsedc.concern.event.ConcernBaseEncryptedEvent;
import it.cnr.isti.labsedc.concern.utils.KieLauncher;
import it.cnr.isti.labsedc.concern.utils.Encrypter;
import it.cnr.isti.labsedc.concern.notification.NotificationManager;
import it.cnr.isti.labsedc.concern.ConcernApp;

dialect "java"

declare ConcernBaseEncryptedEvent
    @role( event )
    @timestamp( timestamp )
    @expires( 2m )
end

rule "CRYPTO_db_amplification"

when
    $aEvent : ConcernBaseEncryptedEvent(
        this.senderID == "ENCRYPTED_Probe",
        this.destinationID == "Monitoring",
        this.name == "EncryptedMessage",
        this.encryption == "AES",
        this.consumed == false);
        
then
    String clear = Encrypter.decrypt($aEvent.getData().toString(),$aEvent.getEncryption());
    $aEvent.setConsumed(true);
    $aEvent.setData(clear);

    ConcernApp test = (ConcernApp)ConcernApp.getInstance();
    test.getStorageController().saveMessage($aEvent);
    test.getStorageController().saveMessage($aEvent);
    test.getStorageController().saveMessage($aEvent);

    update($aEvent);
end

2026-01-20T12:08:07.610+0100 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne load rules received into the knowledgeBase
2026-01-20T12:08:07.610+0100 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - How many rules within package: it.cnr.isti.labsedc.concern.event 2
2026-01-20T12:08:12.992+0100 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne receives rules //created Jan 24, 2023 - 17:41:32
package it.cnr.isti.labsedc.concern.event;
import it.cnr.isti.labsedc.concern.event.ConcernAbstractEvent;
import it.cnr.isti.labsedc.concern.event.ConcernProbeEvent;
import it.cnr.isti.labsedc.concern.event.ConcernBaseEncryptedEvent;
import it.cnr.isti.labsedc.concern.utils.KieLauncher;
import it.cnr.isti.labsedc.concern.utils.Encrypter;
import it.cnr.isti.labsedc.concern.notification.NotificationManager;
import it.cnr.isti.labsedc.concern.ConcernApp;

dialect "java"

declare ConcernBaseEncryptedEvent
    @role( event )
    @timestamp( timestamp )
    @expires( 2m )
end

rule "CRYPTO_event_fanout"
when
    $aEvent : ConcernBaseEncryptedEvent(
        this.senderID == "ENCRYPTED_Probe",
        this.destinationID == "Monitoring",
        this.name == "EncryptedMessage",
        this.encryption == "AES",
        this.consumed == false
    );
then
    String clear = Encrypter.decrypt($aEvent.getData().toString(),$aEvent.getEncryption());
    ConcernApp test = (ConcernApp)ConcernApp.getInstance();
    
    for (int i = 0; i < 20; i++) {
        ConcernBaseEncryptedEvent ne =
            new ConcernBaseEncryptedEvent(
            $aEvent.getTimestamp(),
            $aEvent.getSenderID(),
            $aEvent.getDestinationID(),
            $aEvent.getSessionID(),
            $aEvent.getChecksum(),
            $aEvent.getName(),
            Encrypter.encrypt(clear,$aEvent.getEncryption()),
            $aEvent.getCepType(),
            false,
            $aEvent.getEncryption());
        insert(ne);
        test.getStorageController().saveMessage($aEvent);
    }
    $aEvent.setConsumed(true);
    update($aEvent);
end

2026-01-20T12:08:13.021+0100 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne load rules received into the knowledgeBase
2026-01-20T12:08:13.021+0100 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - How many rules within package: it.cnr.isti.labsedc.concern.event 3
2026-01-20T12:08:17.836+0100 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne receives rules //created Jan 24, 2023 - 17:41:32
package it.cnr.isti.labsedc.concern.event;
import it.cnr.isti.labsedc.concern.event.ConcernAbstractEvent;
import it.cnr.isti.labsedc.concern.event.ConcernProbeEvent;
import it.cnr.isti.labsedc.concern.event.ConcernBaseEncryptedEvent;
import it.cnr.isti.labsedc.concern.utils.KieLauncher;
import it.cnr.isti.labsedc.concern.utils.Encrypter;
import it.cnr.isti.labsedc.concern.notification.NotificationManager;


dialect "java"

declare ConcernBaseEncryptedEvent
    @role( event )
    @timestamp( timestamp )
    @expires( 2m )
end

rule "CRYPTO_repeated_decrypt_stress"
salience 50
when
    $aEvent : ConcernBaseEncryptedEvent(
        this.senderID == "ENCRYPTED_Probe",
        this.destinationID == "Monitoring",
        this.name == "EncryptedMessage",
        this.encryption == "AES"
    );
then
    for (int i = 0; i < 10; i++) {
    	String clear = Encrypter.decrypt($aEvent.getData().toString(),$aEvent.getEncryption());
    }
    $aEvent.setConsumed(true);
    update($aEvent);
end

2026-01-20T12:08:17.861+0100 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - ...CEP named InstanceOne load rules received into the knowledgeBase
2026-01-20T12:08:17.861+0100 [ActiveMQ Session Task-1] INFO  it.cnr.isti.labsedc.concern.cep.DroolsComplexEventProcessorManager - How many rules within package: it.cnr.isti.labsedc.concern.event 4
2026-01-20T12:11:44.058+0100 [grizzly-http-server-3] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Waiting for broker stop
2026-01-20T12:11:44.059+0100 [grizzly-http-server-3] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - broker stopped
2026-01-20T12:11:44.059+0100 [grizzly-http-server-3] DEBUG it.cnr.isti.labsedc.concern.broker.ActiveMQBrokerManager - Connector Stopped
